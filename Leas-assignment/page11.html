<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Digital Closet: Dress for Safety</title>
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Playfair+Display&display=swap" rel="stylesheet" />
<style>
  
  body, html {
    cursor: url('https://cdn.iconscout.com/icon/free/png-256/magic-wand-1801617-1522645.png') 16 16, auto;
  }

  body {
    margin: 0; padding: 0;
    background: url('castle_bg.jpg') center/cover no-repeat fixed;
    font-family: 'Playfair Display', serif;
    color: #4b004b;
    display: flex;
    flex-direction: column;
    align-items: center;
    height: 540px;
    width: 960px;
    user-select: none;
    overflow: hidden;
    box-sizing: border-box;
    padding: 12px;
  }

  h1 {
    font-family: 'Great Vibes', cursive;
    font-size: 2.1rem;
    margin: 12px 0 18px;
    text-shadow: 0 0 10px #f9c6de;
    user-select: none;
    letter-spacing: 0.04em;
    text-align: center;
  }

  .game-container {
    display: flex;
    gap: 14px;
    width: 920px;
    height: 360px;
    background: rgba(255, 240, 250, 0.92);
    border: 3px solid #ffb6c1;
    border-radius: 22px;
    box-shadow: 0 10px 35px rgba(255, 182, 193, 0.55);
    padding: 14px;
    box-sizing: border-box;
    user-select: none;
  }

  .items-list, .closet {
    background: #fff0f5;
    border: 2px solid #ff8db0;
    border-radius: 18px;
    padding: 14px 10px 18px;
    box-sizing: border-box;
    overflow-y: auto;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 12px;
    box-shadow: inset 0 2px 10px #ffe5f0;
  }

  .items-list {
    width: 45%;
    max-height: 350px;
  }

  .closet {
    width: 50%;
    min-height: 200px;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    position: relative;
    padding-top: 10px;
    box-shadow: 0 0 25px 5px #d147a399;
    transition: border-color 0.3s ease, box-shadow 0.3s ease;
  }

  .closet.highlight {
    border-color: #d147a3;
    box-shadow: 0 0 25px 8px #d147a3cc;
    animation: pulseHighlight 1.5s ease-in-out infinite alternate;
  }

  @keyframes pulseHighlight {
    from { box-shadow: 0 0 25px 5px #d147a399; }
    to { box-shadow: 0 0 35px 10px #d147a3ee; }
  }

  .closet > div {
    font-size: 1rem;
    color: #7a255d;
    font-weight: 600;
    text-align: center;
    user-select: none;
  }

  .item {
    width: 70px;
    height: 70px;
    background: #ff9cc9;
    border-radius: 14px;
    box-shadow: 0 5px 12px rgba(255, 105, 180, 0.4);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: grab;
    user-select: none;
    font-weight: 600;
    text-align: center;
    padding: 6px 8px;
    font-size: 0.75rem;
    color: #660033;
    transition: transform 0.15s ease, background 0.25s ease, box-shadow 0.25s ease;
  }

  .item:active {
    cursor: grabbing;
    transform: scale(1.15);
    background: #ff69b4;
    box-shadow: 0 8px 20px rgba(255, 105, 180, 0.6);
  }
  .item:focus {
    outline: 2px solid #d147a3;
    outline-offset: 2px;
  }


  .item.drop-animate {
    animation: dropFadeScale 0.4s forwards;
  }

  @keyframes dropFadeScale {
    to {
      opacity: 0;
      transform: scale(0.5);
    }
  }

  #feedback {
    font-size: 1rem;
    font-weight: 700;
    color: #4b004b;
    text-align: center;
    text-shadow: 0 0 8px #f9c6de;
    border-radius: 16px;
    padding: 10px 16px;
    width: 920px;
    height: 44px;
    box-sizing: border-box;
    margin: 6px 0 2px;
    user-select: none;
    transition: box-shadow 0.5s ease, background-color 0.3s ease, opacity 0.6s ease;
    background: #ffeef7;
    box-shadow: inset 0 0 20px #ffa1cb80;
    opacity: 0;
  }
  #feedback.glow-green {
    background: #d7f6de;
    box-shadow: 0 0 18px 6px #3cb371cc;
    color: #2e6b2e;
    opacity: 1;
  }
  #feedback.glow-red {
    background: #ffe5e5;
    box-shadow: 0 0 18px 6px #ff4500cc;
    color: #b02a2a;
    opacity: 1;
  }

  #continueBtn {
    margin-top: 6px;
    background: gold;
    color: #4b004b;
    border: none;
    border-radius: 18px;
    padding: 10px 28px;
    font-size: 1.1rem;
    font-weight: 700;
    cursor: pointer;
    box-shadow: 0 5px 20px rgba(255, 215, 0, 0.8);
    transition: background 0.3s ease, transform 0.3s ease;
    width: fit-content;
    display: block;
    margin-left: auto;
    margin-right: auto;
    visibility: hidden;
    user-select: none;
    font-family: Georgia, serif;
  }
  #continueBtn.visible {
    visibility: visible;
  }
  #continueBtn:hover, #continueBtn:focus {
    background: linear-gradient(to right, gold, orange);
    transform: scale(1.07);
    outline: none;
    box-shadow: 0 8px 30px rgba(255, 165, 0, 1);
  }
</style>
</head>
<body>
  <!-- Background Music -->
  <audio id="bgMusic" src="mystery.mp3" loop></audio>
  <audio id="soundCorrect" src="correct.mp3" preload="auto"></audio>
  <audio id="soundWrong" src="wrong.mp3" preload="auto"></audio>
  <audio id="mouseClick" src="mouse.mp3" preload="auto"></audio>

  <h1>Digital Closet: Dress Aurora for Online Safety</h1>
  <div class="game-container" role="main" aria-label="Interactive online safety dressing game">
    <div class="items-list" id="itemsList" aria-label="Draggable safety and risky items list" tabindex="0"></div>
    <div class="closet" id="closet" aria-label="Aurora's closet - drop items here" tabindex="0">
      <div>Drag 5 items here to help Aurora stay safe online!</div>
    </div>
  </div>

  <div id="feedback" role="alert" aria-live="polite" aria-atomic="true"></div>
  <button id="continueBtn" aria-label="Continue to final page button">Continue to Final Page</button>

<script>
  const itemsData = [
    { name: "Privacy Settings", safe: true },
    { name: "Parental Guidance", safe: true },
    { name: "Watermarked Photos", safe: true },
    { name: "Location Tagging", safe: false },
    { name: "Stranger DM", safe: false },
    { name: "Sharing Passwords", safe: false },
    { name: "Strong Password", safe: true },
    { name: "Two-Factor Auth", safe: true },
    { name: "Oversharing", safe: false },
  ];

  const itemsList = document.getElementById('itemsList');
  const closet = document.getElementById('closet');
  const feedback = document.getElementById('feedback');
  const continueBtn = document.getElementById('continueBtn');
  const bgMusic = document.getElementById('bgMusic');
  const soundCorrect = document.getElementById('soundCorrect');
  const soundWrong = document.getElementById('soundWrong');
  const mouseClick = document.getElementById('mouseClick');

  let selectedCount = 0;
  const maxSelections = 5;
  let keyboardDragItem = null;
  let feedbackTimeout = null;


  function shuffle(array) {
    for(let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  }

  function createDraggableItem(item) {
    const div = document.createElement('div');
    div.className = 'item';
    div.textContent = item.name;
    div.setAttribute('draggable', true);
    div.setAttribute('role', 'button');
    div.setAttribute('tabindex', '0');
    div.setAttribute('aria-grabbed', 'false');

    div.addEventListener('dragstart', dragStart);
    div.addEventListener('keydown', keyboardDragStart);
    div.addEventListener('dragend', dragEnd);

    return div;
  }

  function dragStart(e) {
    e.dataTransfer.setData('text/plain', e.target.textContent);
    e.dataTransfer.effectAllowed = 'move';
    e.target.setAttribute('aria-grabbed', 'true');
  }

  function keyboardDragStart(e) {
    if(e.key === 'Enter' || e.key === ' ') {
      e.preventDefault();
      e.target.setAttribute('aria-grabbed', 'true');
      keyboardDragItem = e.target;
    }
  }

  function dragEnd(e) {
    e.target.setAttribute('aria-grabbed', 'false');
  }

  closet.addEventListener('dragover', (e) => {
    e.preventDefault();
    closet.classList.add('highlight');
    e.dataTransfer.dropEffect = 'move';
  });

  closet.addEventListener('dragleave', () => {
    closet.classList.remove('highlight');
  });

  closet.addEventListener('drop', (e) => {
    e.preventDefault();
    closet.classList.remove('highlight');
    const itemName = e.dataTransfer.getData('text/plain');

    const draggedItem = Array.from(itemsList.children).find(child => child.textContent === itemName);
    if(draggedItem) {
      handleDrop(draggedItem, itemName);
    }
  });

  closet.addEventListener('keydown', (e) => {
    if((e.key === 'Enter' || e.key === ' ') && keyboardDragItem) {
      e.preventDefault();
      const itemName = keyboardDragItem.textContent;
      const draggedItem = Array.from(itemsList.children).find(child => child === keyboardDragItem);
      if(draggedItem) {
        handleDrop(draggedItem, itemName);
      }
      keyboardDragItem.setAttribute('aria-grabbed', 'false');
      keyboardDragItem = null;
    }
  });

  function handleDrop(itemElement, itemName) {
    playSelectionSound(itemName);
    showFeedback(itemName);

    // Animate and remove item independently from feedback
    itemElement.classList.add('drop-animate');
    itemElement.addEventListener('animationend', () => {
      if(itemElement.parentNode) {
        itemElement.parentNode.removeChild(itemElement);
      }
    }, { once: true });

    selectedCount++;
    if(selectedCount >= maxSelections) {
      endGame();
    }
  }

  function playSelectionSound(itemName) {
    const item = itemsData.find(i => i.name === itemName);
    if(!item) return;

    if(item.safe) {
      playSound(soundCorrect);
    } else {
      playSound(soundWrong);
    }
  }

  function showFeedback(itemName) {
    const item = itemsData.find(i => i.name === itemName);
    if(!item) return;

    feedback.classList.remove('glow-green', 'glow-red');

    if(item.safe) {
      feedback.textContent = `Great! "${itemName}" helps keep Aurora safe! ðŸŒŸ`;
      feedback.classList.add('glow-green');
    } else {
      feedback.textContent = `Careful! "${itemName}" could put Aurora at risk! âš ï¸`;
      feedback.classList.add('glow-red');
    }

    feedback.style.opacity = '1';

    if(feedbackTimeout) clearTimeout(feedbackTimeout);

    feedbackTimeout = setTimeout(() => {
      feedback.style.opacity = '0';
      feedbackTimeout = null;
    }, 5000);
  }

  function playSound(sound) {
    sound.currentTime = 0;
    sound.play().catch(() => {});
  }

  function endGame() {
    itemsList.innerHTML = '';
    closet.innerHTML = `<div style="text-align:center; user-select:none; font-weight:600; color:#7a255d; font-size:1rem; padding-top: 24px;">Thanks for helping Aurora stay safe online! Share your knowledge with friends and family.</div>`;
    feedback.classList.remove('glow-green', 'glow-red');
    continueBtn.classList.add('visible');
  }

  continueBtn.addEventListener('click', () => {
    playSound(mouseClick);
    window.location.href = 'final.html';
  });


  window.addEventListener('load', () => {
    bgMusic.volume = 0.3;
    const playPromise = bgMusic.play();
    if (playPromise !== undefined) {
      playPromise.catch(() => {});
    }
  });

  shuffle(itemsData).forEach(item => {
    itemsList.appendChild(createDraggableItem(item));
  });
</script>
</body>
</html>












